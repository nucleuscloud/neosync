on:
  pull_request:
    paths:
      - "**/go.mod"
      - "**/go.sum"

name: Go Work
jobs:
  go-work:
    name: Go Work Sync
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Set up Go
        uses: actions/setup-go@v4

      - name: sync
        run: go work sync

      - name: check
        run: |
          AGAINST=HEAD
          RESULT=$(git diff --name-only $AGAINST | wc -l)

          if [ $RESULT -eq 0 ]; then
            echo "There were changes after running go work sync!. Please run this locally and commit your changes."
            exit 0
          else
            exit 1
          fi
