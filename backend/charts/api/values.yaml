image:
  repository: ghcr.io/nucleuscloud/neosync/api
  # Overrides the image tag whose default is {{ printf "v%s" .Chart.AppVersion }}
  tag:
  pullPolicy:

nameOverride:
fullnameOverride:

imagePullSecrets: []

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # The name of the service account to use. If namenot set and create is true, a name is generated using fullname template
  name:
  annotations: {}
  #   eks.amazonaws.com/role-arn: arn:aws:iam::AWS_ACCOUNT_ID:role/IAM_ROLE_NAME

# Determines what .env file to load in if running bare metal
# also adds a tag to the API logger
nucleusEnv:

# Currently does not do anything but will eventaully allow emitting otel metrics and traces
otel:
  enabled: false
  otlpPort: 4317

# Specify database connection information for the backend to connect to
db:
  host:
  name:
  port: 5432
  username:
  password:
  disableSsl: false
  options:

# Specify connection information for the migrations init container
migrations:
  db:
    host:
    name:
    port: 5432
    username:
    password:
    disableSsl: false
    schemaDir: /migrations
    migrationsTableName: neosync_api_schema_migrations
    migrationsTableQuoted: false
    options:

# Set requests and limits on the backend to change its performance
resources:
  # These are low-usage defaults. Change these depending on your needs.
  requests:
    cpu: "100m"
    memory: "128Mi"
  limits:
    cpu: "500m"
    memory: "512Mi"

# Configure autoscaling of the container
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 4
  targetCPUUtilizationPercentage: 80

# Adds annotations and labels to the deployment to opt it in to Istio service mesh. See the Neosync k8s docs for more details.
istio:
  enabled: false

# Adds annotations to support sending logs to Datadog. See the Neosync k8s docs for more details.
datadog:
  enabled: false

# Sets the host that the backend will listen on. 0.0.0.0 is common for Kubernetes workloads.
host: 0.0.0.0

# The K8s service port
servicePort: 80
# The container port
containerPort: 8080

terminationGracePeriodSeconds:
shutdownTimeoutSeconds:

# Configure the backend to use authentication. This will allow it to communicate with a JWT-based auth service such as keycloak.
auth:
  enabled: false
  # The audience that is expected to be present in the JWT aud claim
  audience:
  # The base url of the auth server
  baseUrl:
  # The client id that the CLI will use to communicate with the backend for authentication (if auth is enabled)
  cliClientId:
  # The aud that is expected to be present when the CLI auths to the backend
  cliAudience:
  # A map of clientId->clientSecret of allowed clients
  clientMap:
  # API Service Account credentials. This is used by the service itself to perform admin actions against the auth service.
  api:
    clientId:
    clientSecret:
    baseUrl:
    provider:

temporal:
  # default value based on how Temporal manifests are by default configured
  # change this based on your temporal configuration
  url: temporal.temporal:7233
  # if not provided, falls back to hardcoded default value
  defaultNamespace:
  # if not provided, falls back to hardcoded default value
  defaultSyncJobQueue:
  certificate:
    keyFilePath:
    certFilePath:

    keyContents:
    certContents:

tolerations: []
nodeSelector: {}

volumes: []
volumeMounts: []

neosyncCloud:
  enabled: false
  workerApiKeys: []

# currently this is used for k8s pods runLogs but is deprecated and runLogs should be configured instead
kubernetes:
  enabled: true
  # falls back to the helm release namespace
  namespace:
  # corresponds with the app label that is present on the worker pod
  workerAppName: neosync-worker

# is runLogs are disabled, will fallback on the kubernetes configuration above for backwards compat
runLogs:
  # Independently set so that configuration can exist but logs can still be independently disabled
  # defaults to true with k8s-pods configuration for backwards compat and because this is a helm chart this is defacto kubernetes
  enabled: true
  # possible values: k8s-pods, loki
  type: k8s-pods

  podConfig:
    workerNamespace: # falls back to the release namespace
    workerAppName: neosync-worker
  lokiConfig:
    baseUrl: # base url to loki instance
    labelsQuery: # LogQL labels query (without the {} as those are provided by the system)
    keepLabels: # list form

# check out the ingress.yaml file to see what values are available for configuration on this object.
ingress:
  # enable this if using K8s ingress to expose the backend to the internet
  enabled: false

# configure whether or not the api should expose the service metrics proto
protometrics:
  # will enable the metrics service proto
  enabled: false
  # the url, will default to http://localhost:9090 if not provided
  url:
  # optionally provide an API key if the prometheus service requires authentication
  apiKey:

updateStrategy:

# Provide extra environment variables that will be applied to the deployment.
extraEnvVars: []
